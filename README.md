# AI Tour Search - Поиск туров с ИИ

Веб-приложение для поиска туров с использованием искусственного интеллекта, LLM и векторной базы данных Milvus.

## 🚀 Возможности

- **ИИ-ассистент**: Умный поиск туров с использованием LLM (Ollama)
- **Векторная база данных**: Быстрый поиск по векторной базе данных Milvus
- **Инструменты**: Доступ к различным инструментам для поиска информации
- **Современный UI**: Красивый и удобный веб-интерфейс
- **Real-time поиск**: Мгновенная обработка запросов пользователей

## 📋 Требования

- Python 3.8+
- Ollama (локально или удаленно)
- Milvus сервер
- MCP серверы (опционально)

## 🛠️ Установка

1. **Клонируйте репозиторий:**
```bash
git clone <repository-url>
cd ai-tour-search
```

2. **Создайте виртуальное окружение:**
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows
```

3. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

4. **Настройте переменные окружения:**
```bash
cp env_example.txt .env
# Отредактируйте .env файл с вашими настройками
```

5. **Запустите Ollama (если локально):**
```bash
# Установите Ollama с https://ollama.ai
ollama pull qwen3:8b
ollama pull nomic-embed-text:v1.5
```

## ⚙️ Конфигурация

### Переменные окружения

Создайте файл `.env` на основе `env_example.txt`:

```env
# Milvus Configuration
MILVUS_TOKEN=your_milvus_token_here
MILVUS_URI=http://{you-url-here}:19530

# Ollama Configuration
OLLAMA_BASE_URL=http://localhost:11434

# Flask Configuration
FLASK_ENV=development
FLASK_DEBUG=False
```

### MCP Серверы (опционально)

Приложение поддерживает подключение к MCP серверам:
- RAG tool сервер с Milvus (порт 9011) - **ОБЯЗАТЕЛЬНО для полной функциональности**
- Web tool сервер (порт 9010)

## 🚀 Запуск

1. **Проверьте подключение (рекомендуется):**
```bash
python test_milvus_connection.py
```

2. **Создайте Milvus коллекцию (первый раз):**
```bash
python create_milvus_collection.py
```

3. **Запустите RAG сервер с Milvus (в отдельном терминале):**
```bash
python start_rag_server.py
```

4. **Запустите основное приложение:**
```bash
python app.py
```

5. **Откройте браузер:**
```
http://localhost:5000
```

**Примечание:** Если хотите добавить больше туров, используйте:
```bash
python add_tours.py
```

## 📖 Использование

1. **Введите запрос** в текстовое поле (например: "Ищу тур в Европу на 7 дней, бюджет до 1000 евро")
2. **Нажмите "Найти туры"** для начала поиска
3. **Дождитесь результата** - ИИ обработает ваш запрос и найдет подходящие варианты
4. **Просмотрите результаты** в удобном формате

## 🏗️ Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Flask App     │    │   LLM/Ollama    │
│   (HTML/JS)     │◄──►│   (Python)      │◄──►│   (qwen3:8b)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                              │
                              ▼
                       ┌─────────────────┐
                       │   Milvus DB     │
                       │   (Vector DB)   │
                       └─────────────────┘
                              │
                              ▼
                       ┌─────────────────┐
                       │   MCP Tools     │
                       │   (Jira, etc.)  │
                       └─────────────────┘
```

## 🔧 API Endpoints

- `GET /` - Главная страница
- `POST /search` - Поиск туров
- `GET /health` - Проверка состояния сервиса

### Пример запроса к API:

```bash
curl -X POST http://localhost:5000/search \
  -H "Content-Type: application/json" \
  -d '{"query": "Ищу тур в Европу на 7 дней"}'
```

## 🐛 Устранение неполадок

### Проблемы с Ollama
- Убедитесь, что Ollama запущен: `ollama serve`
- Проверьте доступность моделей: `ollama list`

### Проблемы с Milvus
- Проверьте подключение к Milvus серверу
- Убедитесь, что токен установлен правильно

### Проблемы с MCP
- Проверьте, что MCP серверы запущены на указанных портах
- Убедитесь в правильности URL в конфигурации

## 📝 Лицензия

MIT License

## 🤝 Вклад в проект

1. Fork репозитория
2. Создайте ветку для новой функции
3. Commit изменения
4. Push в ветку
5. Создайте Pull Request

## 📞 Поддержка

Если у вас есть вопросы или проблемы, создайте issue в репозитории. 